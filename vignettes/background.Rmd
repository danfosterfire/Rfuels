---
title: "Background and References"
author: "Danny Foster"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Background}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

```

#Introduction

This method for calculating fuel loads from Brown's transects was originally 
described in Stephens (2001). Specifically:

> "Surface and ground fuel loads were calculated by using appropriate equations 
developed for Sierra Nevada forests (van Wagtendonk et al. 1996, 1998). 
Coefficients required to calculate all surface and ground fuel loads were 
arithmetically weighted by the basal area fraction (percentage of total basal 
area by species) to produce accurate estimates of fuel loads (Jan van 
Wagtendonk, personal communication, 1999)." 

Since then, the method has been used repeatedly in other publications, 
particularly those related to the Fire-Fire-Surrogate study at Blodgett Forest 
Reserach Station, e.g. Stephens and Moghaddas (2005) and Stephens 
et al. (2012). At some point, Jason Moghaddas constructed an excel workbook 
(with included macros) to facilitate use of the method for new datasets. 

The this package implements the method in R, using Moghaddas' 
implementation (and various publications) for reference. The goal of this 
effort is to make the method more accessible, transparent, and reproducible 
for use in future research.

This method requires Brown's transect data and plot (or stand) level overstory 
data. Brown (1974) describes the widely used fuels transect sampling protocol 
and provides equations used to calculate fuel loads for woody debris from the 
transect samples. 

The general idea of Stephens's modification of the method is to refine the 
fuel load estimates by using overstory data to improve the accuracy of 
coefficents used in Brown's equations to calculate 
fuel loads from transect data. Specifically, QMD, SEC, and SG are coefficients 
which vary by the species that is the fuel source, and so better estimates can 
(presumably) be derived by using species-weighted-average values for QMD, SEC, 
and SG rather than using Brown's given values, which are generalized for 
entire regions. (See below for definitions of QMD, SEC, and SG.)

**Note:** This implementation of the method assumes the user is working in the 
Sierra Nevada. Any species not included in the Van Wagtendonk et al. tables 
below is assigned their "All Species" value by default. Also, per the usage of 
Moghaddas' spreadsheet for previous studies, I have elected to include both 
live and dead trees in the basal-area calculations for the purposes of 
calculating fuel loads.

This method breaks forest fuels into three main categories, each of which has a 
particular implementation for calculating the fuel load represented by transect 
samples.

#Litter and Duff

Litter and duff are measured as depths as specific points along a sampling 
transect. Van Wagtendonk (1998) developed regressions for litter, Duff, and 
combined-litter-and-duff loading (kg/$m^2$) as a function of depth (cm) for 19 
different Sierra Nevada conifer species: 

```{r echo = FALSE}
knitr::kable(Rfuels:::litterduff_coeffs,
             caption = 'Van Wagtendonk et al. (1998) Table 7: Regression statistics for litter, duff, and litter and duff weight (kg m-2) as a function of their respective depths (cm) for 19 Sierra Nevada conifers')
```

The fuel load represented by a depth measurement under a mixed-species overstory can be estimated using the equation

$$F_{d,plot} = d * Coeff_{plot}$$

where:

  - $F_{d,plot}$ is the fuel load (in kg/$m^2$)

  - $d$ is the depth of litter, duff, or litter and duff together (in cm) at some 
  point along the transect. If depth was taken at multiple points along the 
  transect, average them together to calculate *d*.

  - $Coeff_{plot}$ is the best estimate coefficient for the linear relationship 
  between depth and fuel load for a fuel bed generated by the overstory present 
  at *plot*

We can calculate $Coeff_{plot}$ by averaging together the different species-specific 
coefficients for each tree species contributing fuel to the plot, weighted by 
their local prevalence. Specifically, we weight each species' coefficient by 
the proportion of total basal area contributed by that species:

$$Coeff_{plot} = \sum_{spp}{[(\frac{BA_{spp}}{BA_{total}})*Coeff_{spp}]}$$

Where 

  - $Coeff_{spp}$ is the species-specific coefficient for species *spp*, 
  
  - $Coeff_{plot}$ is the best estimate multiple-species coefficient we will 
  use to estimate the fuel load for transects taken in the plot

  - $BA_{spp}$ and $BA_{total}$ are the basal area occupied by species *spp* 
  and the total overstory basal area (respectively) in the plot. 
  
  - $\frac{BA_{spp}}{BA_{total}}$ is proportion of the plot's basal area 
  occupied by species *spp*. 

This esimate of the fuel load represented by the transect can be averaged with 
other transects at the same plot (which will have the same value for 
$Coeff_{plot}$, but different values for *d*) to generate plot-level 
estimates of fuel load, which can themselves be averaged to generate unit-level 
estimates of fuel load, depending on the user's study design.

#Fine Woody Debris: 1-hour, 10-hour, and 100-hour fuels

Calculating fuel loads represented by transect counts of 1-hour, 10-hour, and 
100-hour fuels is more complicated, but follows the same principle as described 
for litter and duff above. The different timelag classes (which correspond to 
size classes of 0.0-0.64cm, 0.64-2.54cm, and 2.54-7.62cm, respectively) must 
be calculated separately but in a common manner.

Van Wagtendonk et al. (1996) give the equation (modified from Brown 1974):

$$W = \frac{const*QMD*SEC*SLP*SG*n}{length}$$

Where:

  - $W$ is the estimated weight (in tons/acre, kg/ha, etc.) of fine woody 
  debris size class *f* on the plot 

  - $const$ is a constant composed of various unit conversion factors (e.g., 
  to get to tons/acre in the end), described by some authers as *k*

  - $QMD$ is the quadratic mean diameter of the fuels recorded in the transect

  - $SEC$ is the correction for the nonhorizontal angle of the fuels

  - $SLP$ is the slope correction factor, which allows corrected for the effect 
  of a non-horizontal transect on the horizontal distance sampled

  - $SG$ is the specific gravity of the fuels in the transect

  - $n$ is the number of fuel particles intersecting the transect,

  - and $length$ is the length of the transect. 

Procedures for calculating these values are described below. *QMD*, *SEC*, and 
*SG* all vary by timelag classification, and so *W* is calculated 
individually for each timelag (1h, 10h, and 100h).

##Const (k-values)

Equation constant *k* ("const" in van Wagtendonk 1996 and Brown 1974) for 
sampled units and output units. These values for *k* are from van Wagner 
(1982), and these are used by forest service per Woodall and Williams (2008).
(These values are also consistent with Moghaddas' work.)

```{r echo = FALSE}
knitr::kable(Rfuels:::kvals,
             caption = 'Van Wagner (1982) Table 1: Equation constant k for some length, volume, and weight units in line intersect sampling')
```

##QMD, SEC, and SG 

These values vary by species and timelag classification of the fuel being 
totaled. Values for specific species/timelag for fine woody fuels are drawn 
from van Wagtendonk (1996).

###QMD (Quadratic mean diameter in centimeters)

```{r echo = FALSE}
knitr::kable(Rfuels:::QMDcm,
             caption = 'Van Wagtendonk et al. (1996) Table 3: Average squared quadratic mean diameter by fuel size class for 19 Sierra Nevada conifers')
```

These constants are used in combination with overstory data to create an aggregate estimate of QMD, an average of the various species' QMD estimates (from Van Wagtendonk et al.) weighted by the proportion of stand basal area occupied by each species. See the following formula:

$$QMD_{plot,timelag} = \sum_{species=spp}{PropBA_{spp,plot}*QMD_{spp,timelag}}$$

Where 

  - $QMD_{plot}$ is the estimated quadratic mean diameter of fuels in the 
  *timelag* class in the *plot* across all species

  - $PropBA_{spp,plot}$ is the proportion of total basal area in *plot* occupied 
  by the species *spp*, calculated from the measurement data

  - $QMD_{spp,timelag}$ is the QMD of fuels in the *timelag* class for species 
  *spp*, as reported by Van Wagtendonk et al. (1996) Table 3.

###SEC (secant of acute angle)

```{r echo = FALSE}
knitr::kable(Rfuels:::SEC,
             caption = 'Van Wagtendonk et al. (1996) Table 6: Average secant of acute angles of inclination of nonhorizontal particles by fuel size class for 19 Sierra Nevada conifers')
```

A propotion-BA-weighted average of SEC is generated in the same way as QMD above.

###SG (specific gravity)

Note that van Wagtendonk et al. found that "species was not significant for the 
7.62+cm (3+ in) rotten fuels." and that the average specific gravity for rotten 
fuels was .36, which is here included as a value.

```{r echo = FALSE}
knitr::kable(Rfuels:::SG,
             caption = 'Van Wagtendonk et al. (1996) Table 8: Average specific gravity by fuel size class for 19 Sierra Nevada conifers')
```

A propotion-BA-weighted average of SEC is generated in the same way as QMD above.

##SLP (slope correction factor)

*SLP* varies by the plot location and transect 
azimuth, $SLP = c = \sqrt{1+(\frac{percentslope}{100})^2}$ per Brown 1974. 
This is a simple adjustment for the influence of slope on transect length.

##length 

*length* is the length of the sampling transect, and varies by the sampling 
protocol (which may vary from year-to-year) and the timelag class.

##n 

*n* is the number of intersections of the given timeclass in the plane of the 
transect.

#Coarse Woody Debris: 1000-hour fuels

Brown (1974) gives:

$$W_{1000h} = \frac{11.64*\sum{d^2}*s*a*c}{N*l}$$

and notes: 

> "For material 3 inches and larger, square the diameter of each intersected 
piece and sum the squared values ($\sum{d^2}$) for all pieces in the sampled 
area. Compute $\sum{d^2}$ separately for sound and rotten categories. To 
obtain weights or volumes for certain diameter ranges (3 to 9 inches, for 
example), compute $\sum{d^2}$ for the specified range."

This equation is just a special case of the equations given above for 1-100 
hour fuels. 11.64 is a unit conversion factor for US units (*const* as above), 
*s* is the specific gravity of the fuel (*SG* as above), 
*a* is a value for the secant angle (*SEC* as above), and *c* is the slope 
correction factor (*SLP* as above). *N* is the number of transects 
represented in the calculation, and is assumed to be 1 in this method. 
*l* is the transect length, as described above.

The difference is that instead of counted intercepts and an average squared 
quadratic mean diameter, we have the actual sum of squared diameters from the 
measurements directly. 

For sound 1000-hour fuels, we can substitute the BA-weighted-average for a 
specific transect's overstory and re-arrange the equation:

$$W_{1000S} = (\sum{d^2})*(\frac{const*SLP}{length})*\sum_{spp}{(\frac{BA_{spp}}{BA_{total}})*SEC_{spp,1000s})}*(\sum_{spp}{(\frac{BA_{spp}}{BA_{total}})*SG_{spp,1000s}})$$

van Wagtendonk 1998 give species-specific values for QMD, SEC, and SG, for both 
1000-hour sound and 1000-hour rotten fuels. 

Users who have diameter measurements for 1000-hour fuels (which is a 
standard sampling protocol) have actual diameter measurements, and don't need 
the by-species QMD averages from Van Wagtendonk et al. (1996). 

Van Wagtendonk et al. (1996) do not discuss sound vs. rotten 1000-hour fuels, 
stating only that "The average secant of the acute angle to the horizontal for 
the 7.62+ cm (3+in) size class for all species was 2.67 (Table 6)." However, 
actually referring to table six gives very different data, with by-species 
averages recorded and varying from 1.00 to 1.06, with an average of 1.02. I 
believe the text is in error (2.67 bears no resemblance to the data given in 
the table, but it is 7.62 reversed.) 

For SG, "The average specific gravity for rotten fuels was .36." and "species 
was not significant for the 7.62+ cm (3+ in) rotten fuels." Specific gravities 
by species for sound 1000-hour fuels are given in Van Wagtendonk et al. (1996), 
Table 8. 

#References

  - Brown, J. K. *Handbook for Inventorying Downed Woody Material.* USDA For. 
  Serv. Gen. Tech. Rep. 24 (1974). https://www.fs.usda.gov/treesearch/pubs/28647

  - Stephens, S. L. *Fire history differences in adjacent Jeffrey pine and upper 
  montane forests in the eastern Sierra Nevada.* Int. J. Wildl. Fire 10, 161–167 
  (2001). https://doi.org/10.1071/WF01008
  
  - Stephens, S. L. & Moghaddas, J. J. *Experimental fuel treatment impacts on 
  forest structure, potential fire behavior, and predicted tree mortality in a 
  California mixed conifer forest.* For. Ecol. Manage. 215, 21–36 (2005). 
  https://doi.org/10.1016/j.foreco.2005.03.070
  
  - Stephens, S. L., Collins, B. M. & Roller, G. *Fuel treatment longevity in 
  a Sierra Nevada mixed conifer forest.* For. Ecol. Manage. 285, 204–212 (2012).
  https://doi.org/10.1016/j.foreco.2012.08.030
  
  - Van Wagner, C. E. *Practical aspects of the line intersect method.* Forestry 
  18 (1982). http://www.cfs.nrcan.gc.ca/pubwarehouse/pdfs/6862.pdf
  
  - Van Wagtendonk, J. W., Benedict, J. M. & Sydoriak, W. M. *Physical 
  properties of woody fuel particles of Sierra Nevada conifers.* Int. J. Wildl. 
  Fire 6, 117–123 (1996). https://doi.org/10.1071/WF9960117
  
  - Van Wagtendonk, J. W., Benedict, J. M. & Sydoriak, W. M. *Fuel bed 
  characteristics of Sierra Nevada conifers.* West. J. Appl. For. 13, 73–84 
  (1998). https://doi.org/10.1093/wjaf/13.3.73
  

  

